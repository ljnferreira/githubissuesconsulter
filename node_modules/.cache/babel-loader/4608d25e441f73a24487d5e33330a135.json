{"ast":null,"code":"import _regeneratorRuntime from\"/home/ljnferreira/development/github-consulting/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/ljnferreira/development/github-consulting/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/ljnferreira/development/github-consulting/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{Container,Owner,Loading,BackButton,IssuesList,PageActions,FilterList}from'./styles';import{FaArrowLeft}from'react-icons/fa';import api from'../../services/api';export default function Repositorio(_ref){var match=_ref.match;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),repositorio=_useState2[0],setRepositorio=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),issues=_useState4[0],setIssues=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];var _useState7=useState(1),_useState8=_slicedToArray(_useState7,2),page=_useState8[0],setPage=_useState8[1];var _useState9=useState([{state:'all',label:'Todas',active:true},{state:'open',label:'Abertas',active:false},{state:'closed',label:'Fechadas',active:false}]),_useState10=_slicedToArray(_useState9,2),filters=_useState10[0],setFilters=_useState10[1];var _useState11=useState(0),_useState12=_slicedToArray(_useState11,2),filterIndex=_useState12[0],setFilterIndex=_useState12[1];useEffect(function(){function load(){return _load.apply(this,arguments);}function _load(){_load=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var nomeRepo,_ref2,_ref3,repositorioData,issuesData;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:nomeRepo=decodeURIComponent(match.params.repositorio);_context.next=3;return Promise.all([api.get(\"/repos/\".concat(nomeRepo)),api.get(\"/repos/\".concat(nomeRepo,\"/issues\"),{params:{state:filters.find(function(f){return f.active;}).state,per_page:5}})]);case 3:_ref2=_context.sent;_ref3=_slicedToArray(_ref2,2);repositorioData=_ref3[0];issuesData=_ref3[1];setRepositorio(repositorioData.data);setIssues(issuesData.data);console.log(issuesData.data);setLoading(false);case 11:case\"end\":return _context.stop();}}},_callee);}));return _load.apply(this,arguments);}load();},[filters,match.params.repositorio]);useEffect(function(){function loadIssue(){return _loadIssue.apply(this,arguments);}function _loadIssue(){_loadIssue=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var nomeRepo,response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:nomeRepo=decodeURIComponent(match.params.repositorio);_context2.next=3;return api.get(\"/repos/\".concat(nomeRepo,\"/issues\"),{params:{state:filters[filterIndex].state,page:page,per_page:5}});case 3:response=_context2.sent;setIssues(response.data);case 5:case\"end\":return _context2.stop();}}},_callee2);}));return _loadIssue.apply(this,arguments);}loadIssue();},[filterIndex,filters,match.params.repositorio,page]);function handlePage(action){setPage(action==='back'?page-1:page+1);}function handleFilter(index){setFilterIndex(index);}if(loading){return React.createElement(Loading,null,React.createElement(\"h1\",null,\"Carregando...\"));}return React.createElement(Container,null,React.createElement(BackButton,{to:\"/\"},React.createElement(FaArrowLeft,{color:\"#000\",size:30})),React.createElement(Owner,null,React.createElement(\"img\",{src:repositorio.owner.avatar_url,alt:repositorio.owner.login}),React.createElement(\"h1\",null,repositorio.name),React.createElement(\"p\",null,repositorio.description)),React.createElement(FilterList,{active:filterIndex},filters.map(function(filter,index){return React.createElement(\"button\",{type:\"button\",key:filter.label,onClick:function onClick(){return handleFilter(index);}},filter.label);})),React.createElement(IssuesList,null,issues.map(function(issue){return React.createElement(\"li\",{key:String(issue.id)},React.createElement(\"img\",{src:issue.user.avatar_url,alt:issue.user.login}),React.createElement(\"div\",null,React.createElement(\"strong\",null,React.createElement(\"a\",{href:issue.html_url},issue.title),issue.labels.map(function(label){return React.createElement(\"span\",{key:String(label.id)},label.name);})),React.createElement(\"p\",null,issue.user.login)));})),React.createElement(PageActions,null,React.createElement(\"button\",{type:\"button\",onClick:function onClick(){return handlePage('back');},disabled:page<2},\"Voltar\"),React.createElement(\"button\",{type:\"button\",onClick:function onClick(){return handlePage('next');}},\"Proxima\")));}","map":{"version":3,"sources":["/home/ljnferreira/development/github-consulting/src/pages/Repositorio/index.js"],"names":["React","useState","useEffect","Container","Owner","Loading","BackButton","IssuesList","PageActions","FilterList","FaArrowLeft","api","Repositorio","match","repositorio","setRepositorio","issues","setIssues","loading","setLoading","page","setPage","state","label","active","filters","setFilters","filterIndex","setFilterIndex","load","nomeRepo","decodeURIComponent","params","Promise","all","get","find","f","per_page","repositorioData","issuesData","data","console","log","loadIssue","response","handlePage","action","handleFilter","index","owner","avatar_url","login","name","description","map","filter","issue","String","id","user","html_url","title","labels"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react';\r\nimport {Container, Owner, Loading, BackButton, IssuesList, PageActions, FilterList} from './styles';\r\nimport { FaArrowLeft } from 'react-icons/fa';\r\nimport api from '../../services/api';\r\n\r\nexport default function Repositorio({match}){\r\n\r\n  const [repositorio, setRepositorio] = useState({});\r\n  const [issues, setIssues] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [page, setPage] = useState(1);\r\n  const [filters, setFilters] = useState([\r\n    {state: 'all', label: 'Todas', active: true},\r\n    {state: 'open', label: 'Abertas', active: false},\r\n    {state: 'closed', label: 'Fechadas', active: false},\r\n  ]);\r\n  const [filterIndex, setFilterIndex] = useState(0);\r\n\r\n  useEffect(()=> {\r\n    \r\n    async function load(){\r\n      const nomeRepo = decodeURIComponent(match.params.repositorio);\r\n\r\n      const [repositorioData, issuesData] = await Promise.all([\r\n        api.get(`/repos/${nomeRepo}`),\r\n        api.get(`/repos/${nomeRepo}/issues`, {\r\n          params:{\r\n            state: filters.find(f => f.active).state, \r\n            per_page: 5\r\n          }\r\n        })\r\n      ]);\r\n\r\n      setRepositorio(repositorioData.data);\r\n      setIssues(issuesData.data);\r\n      console.log(issuesData.data);\r\n\r\n      setLoading(false);\r\n\r\n    }\r\n\r\n    load();\r\n\r\n  }, [filters, match.params.repositorio]);\r\n\r\n\r\n  useEffect(()=> {\r\n\r\n    async function loadIssue(){\r\n      const nomeRepo = decodeURIComponent(match.params.repositorio);\r\n\r\n      const response = await api.get(`/repos/${nomeRepo}/issues`, {\r\n        params:{\r\n          state: filters[filterIndex].state,\r\n          page,\r\n          per_page: 5,\r\n        },\r\n      });\r\n\r\n      setIssues(response.data);\r\n    }\r\n\r\n    loadIssue();\r\n\r\n  }, [filterIndex, filters, match.params.repositorio, page]);\r\n  \r\n  function handlePage(action){\r\n    setPage(action === 'back' ? page - 1 : page + 1 )\r\n  }\r\n\r\n  function handleFilter(index){\r\n    setFilterIndex(index);\r\n  }\r\n\r\n\r\n  if(loading){\r\n    return(\r\n      <Loading>\r\n        <h1>Carregando...</h1>\r\n      </Loading>\r\n    )\r\n  }\r\n  \r\n  return(\r\n    <Container>\r\n        <BackButton to=\"/\">\r\n          <FaArrowLeft color=\"#000\" size={30} />\r\n        </BackButton>\r\n\r\n        <Owner>\r\n          <img \r\n          src={repositorio.owner.avatar_url} \r\n          alt={repositorio.owner.login} \r\n          />\r\n          <h1>{repositorio.name}</h1>\r\n          <p>{repositorio.description}</p>\r\n        </Owner>\r\n\r\n        <FilterList active={filterIndex}>\r\n          {filters.map((filter, index) => (\r\n            <button\r\n             type=\"button\"\r\n             key={filter.label}\r\n             onClick={()=> handleFilter(index)}\r\n            >\r\n              {filter.label}\r\n            </button>\r\n          ) )}\r\n        </FilterList>\r\n\r\n        <IssuesList>\r\n          {issues.map(issue => (\r\n            <li key={String(issue.id)}>\r\n              <img src={issue.user.avatar_url} alt={issue.user.login} />\r\n\r\n              <div>\r\n                <strong>\r\n                  <a href={issue.html_url}>{issue.title}</a>\r\n\r\n                  {issue.labels.map(label => (\r\n                    <span key={String(label.id)}>{label.name}</span>\r\n                  ))}\r\n\r\n                </strong>\r\n\r\n                <p>{issue.user.login}</p>\r\n\r\n              </div>\r\n\r\n            </li>\r\n          ))}\r\n        </IssuesList>\r\n\r\n        <PageActions>\r\n          <button \r\n          type=\"button\" \r\n          onClick={()=> handlePage('back') }\r\n          disabled={page < 2}\r\n          >\r\n            Voltar\r\n          </button>\r\n\r\n          <button type=\"button\" onClick={()=> handlePage('next') }>\r\n            Proxima\r\n          </button>\r\n        </PageActions>\r\n\r\n    </Container>\r\n  )\r\n}"]},"metadata":{},"sourceType":"module"}